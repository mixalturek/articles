<?xml version="1.0" encoding="ISO-8859-2"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cz" lang="CZ">
<head>

<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2" />
<meta http-equiv="content-language" content="cs" />
<meta http-equiv="content-script-type" content="text/javascript" />
<meta http-equiv="content-style-type" content="text/css" />

<meta name="robots" content="all, follow" />
<meta name="resource-type" content="document" />

<meta name="description" content="Porovnání 3D grafických knihoven OpenGL a Direct3D" />
<meta name="keywords" content="opengl, gl, directx, dx, direct3d, d3d, 3d, grafika" />
<meta name="author" content="all: Michal Turek - Woq; woq (zavináè) seznam.cz" />
<meta name="copyright" content="Copyright (c) 2004 Michal Turek - Woq" /><!-- Ne¾ to vyjde na root.cz :-] -->

<title>OpenGL a Direct3D VI.</title>

<link href="style.css" rel="stylesheet" type="text/css" media="all" />
<link href="print.css" rel="stylesheet" type="text/css" media="print" />

</head>
<body>

<div id="text_stranky">

<h1>OpenGL a Direct3D VI.</h1>

<p id="uvod">Jeliko¾ ná¹ seriál vychází na serveru, který se primárnì zabývá Linuxovými technologiemi, zkusíme porovnat, jak snadno respektive obtí¾nì lze pøenést OpenGL a Direct3D programy do tohoto a dal¹ích ne-Windows systémù. Dále se podíváme i na rychlost renderingu.</p>


<h3>Pøenositelnost programù</h3>

<p>Právì se dostáváme k opravdové lahùdce. Dosud jsem nezmínil, ¾e DirectX je vázáno na technologii <span title="Common Object Model">COM</span> navr¾enou, stejnì jako DirectX, Microsoftem. Nebudu se o ní zbyteènì rozepisovat pøedev¹ím proto, ¾e v podstatì nevím, o co jde :-). Nicménì co vím s naprostou jistotou, je to, ¾e funguje výhradnì pod Windows.</p>

<p>Co se dá je¹tì øíci o pøenositelnosti DirectX? Asi jen to, ¾e døíve nefungovalo ani ve Windows NT <a href="#literatura">[3]</a>. Po odklonu Microsoftu od &quot;dosovských Windows&quot; (Win 9x) se s tím v¹ak muselo nìco udìlat, tak¾e v souèasnosti funguje, kdy¾ nikde jinde, tak alespoò ve v¹ech Windows (tedy 9x, Me, NT, 2000, XP), co¾ ov¹em napø. u¾ivatelùm Linuxu, MacOS a dal¹ích a¾ tak staèit nemusí :-(</p>

<p>Naproti tomu je OpenGL od samého zaèátku koncipováno jako nezávislé na platformì, operaèním systému (a programovacím jazyce). V souèasnosti ho lze najít témìø v¹ude: Unix-like systémy (IRIX, Unix, Linux, Sun Solaris, Free/Open/Net-BSD...), Dos-like systémy (MS-Dos (nevidìl jsem to, ale prý ano <a href="#literatura">[3]</a>), Win 3.x, Windows 9x, Me), Windows NT-like (Windows NT, 2000, XP, IBM OS/2), MacOS, BeOS a dal¹ích. Lze ho najít i na nìkterých palmtopech <a href="#literatura">[3]</a>.</p>

<p>Teoreticky (toto je jen mùj postøeh) by mohlo fungovat i na mobilech s Javou, proto¾e nejnovìj¹í verze tohoto programovacího jazyka OpenGL pøímo podporují. Otázkou je pøedev¹ím rychlost a to, jestli v mobilech není pouze nìjaká osekaná verze - s tímto opravdu nemám zku¹enosti.</p>

<p>Bohu¾el, jak u¾ to bývá, mnoho programátorù jednu z nejdùle¾itìj¹ích vlastností OpenGL, pøenositelnost, doslova vyhazuje oknem (toto není nará¾ka na <b>ten</b> OS, ale jen slovní obrat :-), proto¾e vá¾í své aplikace na nepøenositelné systémové API - vìt¹inou Win32 API. Existuje mno¾ství knihoven, díky kterým mohou být OpenGL programy s velmi malým úsilím libovolnì pøenositelné na úrovni zdrojových kódù. Jmenuji pouze dvì, pravdìpodobnì nejpou¾ívanìj¹í, se kterými mám (kromì Win32 API) nìjaké zku¹enosti: <span title="OpenGL Utility Toolkit">GLUT</span> a <span title="Simple DirectMedia Layer">SDL</span>. GLUT zná asi ka¾dý OpenGL programátor, tak¾e se mu moc vìnovat nebudu. Dá se øíci, ¾e je to (oficiální) roz¹íøení OpenGL o nejvíce systémovì závislé funkce, jako je vytváøení oken a práce s nimi.</p>

<p><a href="http://www.libsdl.org/" target="_blank">SDL</a> je doma na Linuxu, jedná se o knihovnu urèenou primárnì pro tvorbu 2D her, ale díky tomu, ¾e pøímo podporuje OpenGL, není problém ani s 3D grafikou. Pou¾ívám ji od té doby, co jsem pøe¹el na Linux (u¾ to bude skoro rok) a v souèasnosti pracuji na základním kódu pro OpenGL aplikace, který je/bude kompletnì vystavìn na SDL a jeho podknihovnách (SDL_Image, SDL_Sound, SDL_Net aj.). Tak¾e a¾ nìkde uvidíte nápis <strong>Free3D (33D) Basecode</strong>, je to moje práce :-). Zatím je to sice projekt jednoho èlovìka, ale kdyby se chtìl nìkdo pøidat...</p>

<div class="okolo_img"><a href="img/fps_kde.png"><img src="img/n_fps_kde.png" width="200" height="150" alt="OpenGL pod Linuxem (KDE - Plastik)" /></a><br />OpenGL pod Linuxem (KDE - Plastik)</div>

<p></p><!--mezera mezi obrázky-->

<div class="okolo_img"><a href="img/fps_enlight.png"><img src="img/n_fps_enlight.png" width="200" height="150" alt="OpenGL pod Linuxem (Enlightenment)" /></a><br />OpenGL pod Linuxem (Enlightenment)</div>

<p></p><!--mezera mezi obrázky-->

<div class="okolo_img"><a href="img/fps_win.png"><img src="img/n_fps_win.png" width="200" height="150" alt="OpenGL pod MS Windows XP" /></a><br />OpenGL pod MS Windows XP</div>

<h3>Rychlost renderingu</h3>

<p>Jedna z posledních vìcí, které se budeme v tomto èlánku vìnovat, je rychlost OpenGL a Direct3D programù. Pùvodnì jsem chtìl z internetu stáhnout nìjaké Direct3D zdrojové kódy a pøepsat je do OpenGL, nicménì mì upoutal v <a href="#literatura">[3]</a> zaèátek jednoho odstavce: <i>Pøímé srovnání grafického výkonu OpenGL a Direct3D je docela komplikované, proto¾e obì API mají trochu jiné koneèné urèení. OpenGL a Direct3D je navíc tøeba srovnávat pouze pod Windows, proto¾e jinde Direct3D nechodí.</i></p>

<p>Ne¾ jsem tedy zaèal stahovat D3D programy, zkusil jsem nejprve OpenGL program, na kterém právì dìlám (ten èásticový systém vý¹e), spustit pod Mandrake 10.0 Linuxem a následnì ve Windows XP (na stejném poèítaèi), jiné operaèní systémy jsou pro mì v tuto chvíli nedostupné.</p>

<p>To, co teï napí¹u, rozhodnì neberte jako &quot;dal¹í kydání na Windows&quot;. Abych pravdu øekl, výsledná FPS mì, stejnì jako urèitì i vás, totálnì ¹okovala. Pøesto¾e se jednalo o naprosto stejný zdrojový kód zkompilovaný akorát pro dva rùzné systémy, byly výsledky extrémnì odli¹né. Pro kompilaci bylo ve Windows pou¾ito vývojové prostøedí MS Visual C++ 6.0 a v Linuxu standardní g++ (KDevelop):</p>

<pre>
[woq@localhost tmp]$ g++ --version
g++ (GCC) 3.3.2 (Mandrake Linux 10.0 3.3.2-6mdk)
Copyright (C) 2003 Free Software Foundation, Inc.
This is free software; ...atd.
</pre>

<p>Následující tabulka vyjadøuje hodnoty FPS programu po ustálení v &quot;klidovém stavu poèítaèe&quot; - tzn. nic se nemaèká na klávesnici, nehýbá se my¹í apod. Jsou uvedeny minimální a maximální hodnoty. Mo¾ná by bylo lep¹í spoèítat prùmìr za napø. tisíc pøekreslení, ale nechtìlo se mi s tím hrát - rozdíly jsou tak zøetelné, ¾e hovoøí za v¹e.</p>

<center><table>
<thead>
<tr><td></td>					<td colspan="2"><b>FPS - OpenGL</b></td></tr>
<tr><td></td>					<td><b>Okno</b></td>	<td><b>Fullscreen</b></td></tr>
</thead>
<tbody>
<tr><td><b>Win XP</b></td>			<td>37.0 a¾ 38.5</td>	<td>58.8 a¾ 62.5</td></tr>
<tr><td><b>Linux (KDE)</b></td>		<td>62.5 a¾ 66.7</td>	<td>76.9 a¾ 71.4</td></tr>
<tr><td><b>Linux (Enlightenment)</b></td>	<td>38.0 a¾ 83.0</td>	<td>42.0 a¾ 93.0</td></tr>
</tbody>
</table></center>

<p>Pozn.: Námitka, ¾e to dìlá stáøí Visual C++ (vy¹lo myslím 1998), neobstojí. Zkou¹el jsem to i v nejnovìj¹ím Dev-C++ a hodnoty byly prakticky stejné. Navíc ve Windows byl kromì testovaného programu spu¹tìn pouze Total Commander, kde¾to v Linuxu mám standardnì po pracovních plochách rozházených nejménì deset dal¹ích aplikací ((prùmìrnì) 5 KWritù, Operu, Konqueror, Gimp, KDevelop, Konzoli, do toho Apache, MySQL... je toho fakt hodnì).</p>

<p>Kvùli tìmto ne zrovna pozitivním výsledkùm (ve Windows) jsem se rozhodl, porovnání s DirectX neprovádìt, opravdu asi zále¾í hodnì na tom, pod jakým systémem se spustí. Mimochodem, to víte, ¾e OpenGL bì¾í ve Windows vlastnì na Direct3D? I kdy¾ to v programu nikde explicitnì neurèíte, po spu¹tìní v Debug (F5 ve Visual C++), se zobrazí TRACE() zpráva ohlednì DDRAW.DLL. Kdysi jsem o tom vidìl i nadpis nìjakého èlánku na <a href="http://www.opengl.org/" target="_blank">http://www.opengl.org/</a>.</p>

<p>A je¹tì si neodpustím jednu zmínku o rychlosti DirectX. Kdysi se v poèítaèových èasopisech roz¹íøila zpráva, ¾e se po instalaci nové verze (buï 6 nebo 7, u¾ nevím) zvý¹í výkon grafické karty a¾ o 40 procent. V¹ichni jásali, ale napadlo vùbec nìkoho: &quot;A ne¹lo to udìlat poøádnì u¾ v té minulé verzi?!&quot;.</p>


<a id="literatura"></a>
<h3>Literatura</h3>

<ul>
<li>[0] Vlastní zku¹enosti s 3D grafikou</li>
<li>[1] Clayton Walnum: Programujeme grafiku v Microsoft&reg; Direct3D (9.0), Computer Press 2004, první vydání, 358 stran</li>
<li>[2] Chip 01/2004, Hardwarový fotorealismus: Mo¾nosti moderních 3D grafických akcelerátorù, str. 96-100)</li>
<li>[3] <a href="http://nehe.opengl.cz/cl_gl_referat.pdf" target="_blank">Daniel Èech: OpenGL - Referát na praktikum z informatiky (PDF)</a> - Opravdu kvalitní text</li>
<li>[4] <a href="http://nehe.opengl.cz/cl_sdl_hry.pdf" target="_blank">Bernard Lidický: Nìkolik poznámek k tvorbì poèítaèových her (PDF)</a> - Vìnuje se pøedev¹ím tématùm, jaké hry programovat a v èem (pøenositelné knihovny Allegro a SDL)</li>
<li>[5] <a href="http://www.root.cz/clanek/2314">Linuxové hry (47): Unreal Tournament 2004</a> - Hlavní impuls pro vznik tohoto èlánku</li>
</ul>


<div>Pro server <a href="http://www.root.cz/">root.cz</a> napsal</div>
<div>Michal Turek - Woq <span class="m">&lt;WOQ (zavináè) seznam.cz&gt;</span></div>

</div><!-- div id="text_stranky" -->

</body>
</html>