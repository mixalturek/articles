<?xml version="1.0" encoding="ISO-8859-2"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cz" lang="CZ">
<head>

<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2" />
<meta http-equiv="content-language" content="cs" />
<meta http-equiv="content-script-type" content="text/javascript" />
<meta http-equiv="content-style-type" content="text/css" />

<meta name="robots" content="all, follow" />
<meta name="resource-type" content="document" />

<meta name="description" content="Porovnání 3D grafických knihoven OpenGL a Direct3D" />
<meta name="keywords" content="opengl, gl, directx, dx, direct3d, d3d, 3d, grafika" />
<meta name="author" content="all: Michal Turek - Woq; woq (zavináè) seznam.cz" />
<meta name="copyright" content="Copyright (c) 2004 Michal Turek - Woq" /><!-- Ne¾ to vyjde na root.cz :-] -->

<title>OpenGL a Direct3D IV.</title>

<link href="style.css" rel="stylesheet" type="text/css" media="all" />
<link href="print.css" rel="stylesheet" type="text/css" media="print" />

</head>
<body>

<div id="text_stranky">

<h1>OpenGL a Direct3D IV.</h1>

<p id="uvod">Ka¾dý asi ví, ¾e se Direct3D vyvíjí pøevratnou rychlostí, Microsoft neustále uvolòuje jednu verzi za druhou, tak¾e s nejvìt¹í pravdìpodobností bude tato knihovna podporovat v¹echny pøevratné efekty nových grafických karet. V èlánku se tedy budeme orientovat pøedev¹ím na OpenGL a jeho roz¹íøení (extensiony).</p>


<h3>Podpora HW funkcí nových grafických karet</h3>

<p>Právì na tomto tématu spoèívá tíha nejvìt¹í mystifikace &quot;DX fandù&quot;. (Tedy kromì toho, ¾e se <i>OpenGL nemù¾e ve vlastnostech zobrazení...</i> atd.) Ti, co v ¾ivotì nesly¹eli o tzv. OpenGL roz¹íøeních (OpenGL extensions) a naopak sly¹eli, ¾e se OpenGL standard od svého uvedení na zaèátku devadesátých let minulého století nijak výraznì nezmìnil, pravdìpodobnì kroutí nechápavì hlavou. Ani se jim nedivím, v¾dy» karty pøed patnácti lety &quot;skoro nepodporovaly ani textový re¾im&quot; (nad tím v uvozovkách nepøemý¹lejte :-).</p>

<p>Modelová situace: Výrobce karty (NVIDIA, Ati...) pøidá novou pøevratnou vlastnost, pøi jejím¾ pou¾ití se extrémnì urychlí rendering. Za jak dlouho ji mù¾e Woq programátor (analogie na Frantu u¾ivatele, pro na¹e Linuxové kamarády BFU) pou¾ít? Pokud si tuto kartu koupí, aby mìl na èem testovat, a pou¾ívá OpenGL... <strong>ihned</strong>. Pøesto¾e nebyla vytvoøena ¾ádná nová verze (jak bylo uvedeno, standard se témìø nezmìnil), díky extensionùm je mo¾né zpøístupnit jakékoli HW funkce karty.</p>

<p>To, jaká OpenGL roz¹íøení va¹e karta podporuje, mù¾ete zjistit hned nìkolika zpùsoby. Ka¾dého asi napadnou webové stránky výrobce. Tuto mo¾nost bohu¾el nemám ovìøenou, v praxi jsem ji nikdy nepotøeboval - hned pochopíte. Ve Win bych nìco takového hledal asi ve vlastnostech obrazovky, Linux má pøíkaz &quot;glinfo&quot;.</p>

<code><div style="text-align: left">
<div>[woq@localhost tmp]$ <b>glinfo</b></div>
<div><b>GL_VERSION</b>: 1.4.1 NVIDIA 53.36</div>
<div><strong>GL_EXTENSIONS</strong>: GL_ARB_imaging GL_ARB_multitexture GL_ARB_point_parameters GL_ARB_point_sprite GL_ARB_texture_compression GL_ARB_texture_cube_map GL_ARB_texture_env_add GL_ARB_texture_env_combine GL_ARB_texture_env_dot3 GL_ARB_texture_mirrored_repeat GL_ARB_transpose_matrix GL_ARB_vertex_buffer_object GL_ARB_vertex_program GL_ARB_window_pos GL_S3_s3tc GL_EXT_texture_env_add GL_EXT_abgr GL_EXT_bgra GL_EXT_blend_color GL_EXT_blend_minmax GL_EXT_blend_subtract GL_EXT_clip_volume_hint GL_EXT_compiled_vertex_array GL_EXT_draw_range_elements GL_EXT_fog_coord GL_EXT_multi_draw_arrays GL_EXT_packed_pixels GL_EXT_paletted_texture GL_EXT_point_parameters GL_EXT_rescale_normal GL_EXT_secondary_color GL_EXT_separate_specular_color GL_EXT_shared_texture_palette GL_EXT_stencil_wrap GL_EXT_texture_compression_s3tc GL_EXT_texture_cube_map GL_EXT_texture_edge_clamp GL_EXT_texture_env_combine GL_EXT_texture_env_dot3 GL_EXT_texture_filter_anisotropic GL_EXT_texture_lod GL_EXT_texture_lod_bias GL_EXT_texture_object GL_EXT_vertex_array GL_IBM_rasterpos_clip GL_IBM_texture_mirrored_repeat GL_KTX_buffer_region GL_NV_blend_square GL_NV_fence GL_NV_fog_distance GL_NV_light_max_exponent GL_NV_packed_depth_stencil GL_NV_pixel_data_range GL_NV_point_sprite GL_NV_register_combiners GL_NV_texgen_reflection GL_NV_texture_env_combine4 GL_NV_texture_rectangle GL_NV_vertex_array_range GL_NV_vertex_array_range2 GL_NV_vertex_program GL_NV_vertex_program1_1 GL_NVX_ycrcb GL_SGIS_generate_mipmap GL_SGIS_multitexture GL_SGIS_texture_lod GL_SUN_slice_accum</div>
<div><b>GL_RENDERER</b>: GeForce2 MX/AGP/SSE2</div>
<div><b>GL_VENDOR</b>: NVIDIA Corporation</div>
<div><b>GLU_VERSION</b>: 1.3</div>
<div><b>GLU_EXTENSIONS</b>: GLU_EXT_nurbs_tessellator GLU_EXT_object_space_tess</div>
<div><b>GLUT_API_VERSION</b>: 5</div>
<div><b>GLUT_XLIB_IMPLEMENTATION</b>: 15</div>
<div>[woq@localhost tmp]$</div>
</div></code>

<p>S nejvìt¹í pravdìpodobností bude tento pøíkaz dostupný pouze s nainstalovanými NVIDIA drivery, tak¾e pokud u vás nefunguje zkuste prohrabat Ovládací centrum (MDK) nebo KDE nastavení prostøedí - nìkde jsem to tam vidìl. V neposlední øadì mù¾ete zkusit NeHe Tutoriál <a href="http://nehe.opengl.cz/tut_24.php" target="_blank">24 - Výpis OpenGL roz¹íøení</a>, respektive program, který se v nìm vytváøí.</p>

<div class="okolo_img"><a href="img/tut_24.jpg"><img src="img/n_tut_24.jpg" width="200" height="150" alt="Výpis OpenGL roz¹íøení" /></a><br />Výpis OpenGL roz¹íøení</div>

<p>Pøi kódování programu se detekce dostupnosti roz¹íøení provádí pøes volání funkce glGetString(GL_EXTENSIONS), která vrátí ukazatel na øetìzec mezerami oddìlených názvù podporovaných roz¹íøení (podobné jako u výpisu glinfo vý¹e). Pokud je dané roz¹íøení podporováno, zavolá se SDL_GL_GetProcAddress() (ve Win32 API wglGetProcAddress()), které vrátí ukazatel na &quot;HW funkci&quot; implementující dané roz¹íøení. Na následujícím obrázku je vyobrazen hardwarový multitexturing.</p>

<div class="okolo_img"><img src="img/hw_multitex.jpg" width="150" height="100" alt="Multitexturing (HW)" /><br />Multitexturing (HW)</div>

<p>Na druhou stranu, pokud roz¹íøení dostupné není, mù¾e programátor zkusit v¹e dopoèítat softwarovì na CPU - napø. jednoduchý multitexturing lze vytvoøit, mimo jiné, dvìma objekty na stejném místì, ten druhý musí být prùhledný. Pokud si zvìt¹íte screenshot NeHe Tutoriálu <a href="http://nehe.opengl.cz/tut_26.php" target="_blank">26 - Odrazy a jejich oøezávání za pou¾ití stencil bufferu</a>, uvidíte na plá¾ovém míèi &quot;odrazy svìtla&quot;, zpùsobilo je vykreslení druhého poloprùhledného a stejnì velkého objektu s jinou texturou.</p>

<div class="okolo_img"><a href="img/tut_26.jpg"><img src="img/n_tut_26.jpg" width="200" height="150" alt="Multitexturing (SW)" /></a><br />Multitexturing (SW)</div>

<p>V pøípadì slo¾itìj¹ích extensionù (dobrým pøíkladem jsou vertex a fragment shadery), mù¾e být SW implementace &quot;doma na kolenì&quot; nereálná, tak¾e buï aplikace daný grafický efekt nepou¾ije, nebo pokud je tato funkce pro program zásadní, vyhodí program pøi inicializaci <span title="Jednoduché dialogové okno s textem a tlaèítkem OK - pouze Win">MessageBox()</span> s &quot;Extension XXX is not supported!&quot; a ukonèí se.</p>

<p>Kód pro zpøístupnìní jakékoli HW funkce karty v OpenGL, mù¾e vypadat napø. takto (ukázka na multitexturingu):</p>

<pre>
#include &lt;glext.h&gt;// Hlavièka pro extensiony

// Globální ukazatele na multitexturing funkce
PFNGLACTIVETEXTUREARBPROC glActiveTextureARB = NULL;
PFNGLMULTITEXCOORD2FARBPROC glMultiTexCoord2fARB = NULL;

// V Inicializaci
  if(IsExtensionSupported(&quot;GL_ARB_multitexture&quot;))
  {
    glActiveTextureARB = (PFNGLACTIVETEXTUREARBPROC)
      SDL_GL_GetProcAddress(&quot;glActiveTextureARB&quot;);
    glMultiTexCoord2fARB = (PFNGLMULTITEXCOORD2FARBPROC)
      SDL_GL_GetProcAddress(&quot;glMultiTexCoord2fARB&quot;);

    if(!glActiveTextureARB || !glMultiTexCoord2fARB)
    {
      // Multitexturing se nepodaøilo inicializovat
      // Pou¾ít verzi bez HW multitexturingu
    }
  }
  else
  {
    // Multitexturing není podporován
    // Pou¾ít verzi bez HW multitexturingu
  }
</pre>

<p>A jak to probíhá u Direct3D? Opìt stejný scénáø: Woq programátor si za dvacet tisíc koupí novou brutaltotalultraextra grafickou kartu a chce zaèít ve svých programech implementovat v¹echny její vymo¾enosti. S nejvìt¹í pravdìpodobností si nìjakou dobu poèká a¾ se &quot;Ó, veliký Microsoft&reg;&quot; uráèí vydat DirectX 23.0 a po dvacáté druhé se nauèí kompletnì zmìnìné API. Mezitím cena karty klesne na desetinu a a¾ pak mù¾e zaèít programovat.</p>

<p>Ne, omlouvám se, trochu jsem to pøehnal, nicménì dost lidí to tak vidí (já také). V praxi je to tak, ¾e Microsoft spolupracuje s výrobci karet, tak¾e napø. shadery vznikly mimo jiné také díky tomu, ¾e zaèal pracovat na herní konzole XBox <a href="#literatura">[2]</a>. BTW: A pak, ¾e neovlivòuje &quot;podle obrazu svého&quot; vìt¹inu dìní v IT, monopol je holt monopol...</p>


<a id="literatura"></a>
<h3>Literatura</h3>

<ul>
<li>[0] Vlastní zku¹enosti s 3D grafikou</li>
<li>[1] Clayton Walnum: Programujeme grafiku v Microsoft&reg; Direct3D (9.0), Computer Press 2004, první vydání, 358 stran</li>
<li>[2] Chip 01/2004, Hardwarový fotorealismus: Mo¾nosti moderních 3D grafických akcelerátorù, str. 96-100)</li>
<li>[3] <a href="http://nehe.opengl.cz/cl_gl_referat.pdf" target="_blank">Daniel Èech: OpenGL - Referát na praktikum z informatiky (PDF)</a> - Opravdu kvalitní text</li>
<li>[4] <a href="http://nehe.opengl.cz/cl_sdl_hry.pdf" target="_blank">Bernard Lidický: Nìkolik poznámek k tvorbì poèítaèových her (PDF)</a> - Vìnuje se pøedev¹ím tématùm, jaké hry programovat a v èem (pøenositelné knihovny Allegro a SDL)</li>
<li>[5] <a href="http://www.root.cz/clanek/2314">Linuxové hry (47): Unreal Tournament 2004</a> - Hlavní impuls pro vznik tohoto èlánku</li>
</ul>


<div>Pro server <a href="http://www.root.cz/">root.cz</a> napsal</div>
<div>Michal Turek - Woq <span class="m">&lt;WOQ (zavináè) seznam.cz&gt;</span></div>

</div><!-- div id="text_stranky" -->

</body>
</html>