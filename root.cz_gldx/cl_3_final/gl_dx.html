<?xml version="1.0" encoding="ISO-8859-2"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cz" lang="CZ">
<head>

<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2" />
<meta http-equiv="content-language" content="cs" />
<meta http-equiv="content-script-type" content="text/javascript" />
<meta http-equiv="content-style-type" content="text/css" />

<meta name="robots" content="all, follow" />
<meta name="resource-type" content="document" />

<meta name="description" content="Porovnání 3D grafických knihoven OpenGL a Direct3D" />
<meta name="keywords" content="opengl, gl, directx, dx, direct3d, d3d, 3d, grafika" />
<meta name="author" content="all: Michal Turek - Woq; woq (zavináè) seznam.cz" />
<meta name="copyright" content="Copyright (c) 2004 Michal Turek - Woq" /><!-- Ne¾ to vyjde na root.cz :-] -->

<title>OpenGL a Direct3D III.</title>

<link href="style.css" rel="stylesheet" type="text/css" media="all" />
<link href="print.css" rel="stylesheet" type="text/css" media="print" />

</head>
<body>

<div id="text_stranky">

<h1>OpenGL a Direct3D III.</h1>

<p id="uvod">Tento <b>neplánovaný</b> díl je pøedev¹ím reakcí na diskuze k dílùm minulým. Nebudu se moc vìnovat vìcem, jako je èíslování verzí DirectX nebo omyl s DirectPlay, proto¾e je v souèasné chvíli nepova¾uji za podstatné. Berte ho spí¹e jako úvahu na téma: Jaké opravdu zásadní chyby jsem pøi psaní udìlal... a ¾e jich bylo dost :-(</p>


<h3>Budou dal¹í pokraèování?</h3>

<p>Co se mi na root.cz opravdu líbí, je, ¾e ètenáøi pí¹í do diskuzí. Je jedno, jestli se jedná o pochvaly, které se mì ale zrovna netýkají :-(, upozornìní na chyby v èlánku nebo rovnou návrhy na ukonèení seriálu, tìch bylo povícero. Mo¾ná se vám poslední jmenované splní, zatím je¹tì váhám, zále¾í na tom, jaký budu mít pocit, a¾ dopí¹i tento èlánek a pøeètu si následnou diskuzi.</p>

<p>První ze v¹eho bych se chtìl oficiálnì omluvit Johance, která na moji blbost doplatila pravdìpodobnì nejvíce, proto¾e mìla spoustu práce s pøípravou vydání - ne jenom s prvními dvìma díly, ale i <b>dal¹ími</b>, které jsem jí poslal také. Promiò.</p>

<p>Své práce s psaním tohoto seriálu nelituji. I kdy¾ to tak nevypadá, nauèil jsem se spoustu nových vìcí, pøedev¹ím, ¾e nic není dokonalé - viz dále v prùbìhu èlánku. Lituji spí¹e toho, ¾e jsem si bìhem dvou týdnù kompletnì zlikvidoval svou povìst, kterou jsem pracnì budoval pøes tøi roky :-(</p>


<h3>Úvaha na úvod</h3>

<p>Zaènu citací z diskuze k prvnímu dílu: <i>Pamatuju se jak mi kamaradi, kteri me ucili programovat grafiku vzdycky rikali. Pokud neumis programovat v directX a openGL stejne nikdy nekritizuj ten ktery API :)</i></p>

<p>Jo, u¾ to chápu taky, ¹koda, ¾e a¾ teï. Myslel jsem si, ¾e ètyø set stránková kní¾ka o Direct3D by mìla staèit, ale asi opravdu nebyla zrovna kvalitní. Èíst o nìèem a prakticky to pou¾ívat, je obrovský rozdíl. Zkrátka, nepøesvìdèila mì, proè pøejít na Direct3D, spí¹ o tom, proè na nìj nepøejít, a v tomto duchu jsem zaèal psát i seriál. Uznávám, ¾e zále¾í pøedev¹ím na programátorovi, co umí a co si vybere... nicménì nìjaké znalosti tam pøeci jen byly. Asi jsem nemìl zrovna psát, ¾e budu &quot;vaøit z vody&quot;.</p>

<p>Teï u¾ chápu, ¾e DirectX nebude a¾ tak ¹patné, jak jsem si pùvodnì myslel. Do¾ral mì pøedev¹ím autor zmiòovaného èlánku o UT 2004 a právì tím mì nasmìroval ke &quot;kydání na DX&quot;. Vìøte nebo ne, opravdu se mi nìco takového moc èasto nestává.</p>

<p>Ale pøedstavte si tu situaci a opravte mì jestli se mýlím (výzva pøedev¹ím k autorovi èl. UT 2004). Úmyslnì pí¹i do uvozovek... &quot;Pøes dva roky pøekládám po veèerech OpenGL Tutoriály (350 stran A4 !!!) a pak si pøeètu èlánek nìjakého paøana, který o DirectX a OpenGL ví jen to, ¾e existujou a bez nejzákladnìj¹ích znalostí dojde k závìru, ¾e OpenGL je totální sh... zaruèenì hor¹í.&quot;</p>

<p>Po závìreèném ètení: Kdy¾ tak uva¾uji nad tím, co jsem pøed chvílí napsal, stalo se mi úplnì to samé :-(. Ale èestnì, co byste udìlali vy? Zkusili byste alespoò napsat do diskuze, nebo byste si jen pomysleli: &quot;Je to magor, ale a» mu to øekne nìkdo jinej.&quot;? Po pravdì, mì jste to øekli a dìkuji vám za to.</p>

<p>Dále pokusím o rychlé srovnání OpenGL a DirectX (opìt), které by teï u¾ mìlo být alespoò trochu vypovídající. Doufám, ¾e nezaènu opìt ¾ádné bludy.</p>


<h3>Proè ne Direct3D</h3>

<p>Vezmu si jeden modelový objekt (sebe) a v¹e popí¹i na nìm.</p>

<p>První a hlavní dùvod je ten, ¾e jsem se cca. pøed rokem rozhodl øídit heslem nepokrade¹ a opustil Windows. Pøíèinou bylo pøeètení rozhovoru s Billem Gatesem, který zmínil nìco ve smyslu, ¾e pokud by v¹ichni pou¾ívali legální software, tak by mìl Microsoft dostatek penìz na opravení snad v¹ech chyb ve Windows. Øídil jsem se pøesnì jeho výzvou a zahodil v¹echna nelegální CD s programy. Nìkdy mi pøipadá jako paradox, ¾e pou¾íváním GNU/Linuxu defakto poskytuji Microsoftu prostøedky na vývoj Windows, ale pøesnì tak to je :-)</p>

<p>Pokud jste to z minulého odstavce nepochopili, DirectX nefunguje v Linuxu. Nefunguje dokonce ani v Mac OS a ani ve Free/Net/Open-BSD, BeOSu a v¹ech dal¹ích ne-Win* operaèních systémech. Funguje jen a pouze pod MS Windows. Urèitì chápete, ¾e mi to, jako u¾ivateli Linuxu, nemusí a¾ tak úplnì staèit. U OpenGL tento problém kompletnì odpadá, funguje snad v¹ude. Kdy¾ není dostupné DirectX, je to prakticky jediná volba. Nìkdy tak uva¾uji, jestli by se Microsoft vùbec vzpamatoval a nezkrachoval by, kdyby vìt¹ina lidí, pøestala Windows pou¾ívat. V¹imli jste si taky tìch v poslední dobì neustále pøibývajících reklam v poèítaèových èasopisech...?</p>

<p>Jako druhý dùvod lze zmínit mùj &quot;osobní odpor&quot; ke v¹emu, co nese oznaèení Microsoft. Nejsem si a¾ tak jistý, jak u mì vznikl, prostì je. Èastými pády programù této firmy jsem prostì ztratil dùvìru ke v¹em novým verzím, které za nìkolik let vývoje pøidají nové grafické efekty a opraví staré chyby. Prosím, v diskuzi na toto nereagujte.</p>

<p>Øíká se, ¾e Microsoft má monopol na spoustu vìcí týkající se IT, ale dokud si ho nedosadíte za ¹elmu do Janovy Apokalypsy nebo za Velkého bratra do románu 1984 od George Orwella, nemyslím, ¾e budete mít mrazení v zádech a neurèité pocity obav... ale teï u¾ opravdu odbíhám od hlavního tématu.</p>

<p>Tøetím dùvodem je, ¾e mi OpenGL prostì vyhovuje a nemám potøebu se uèit spoustu nových a naprosto odli¹ných vìcí, o kterých si nejsem a¾ tak jistý, jestli by mi byly vùbec k nìèemu. Za dobu, co se vìnuji 3D grafice, jsem potkal pouze jednoho èlovìka, který pøe¹el z OpenGL na DirectX, druhým smìrem jich ale ¹lo asi dvacet - no, deset urèitì. Ale máte pravdu, nemù¾u znát ka¾dého, zvlá¹» z DX strany plotu.</p>

<p>Ona osoba, kterou jsem zmínil v pøedchozím odstavci, uvedla jako hlavní a prakticky jediný dùvod pro pøechod tzv. lep¹í podporu. Nepochopil jsem, co to znamená, ale kdy¾ jsem tohle slovo sly¹el ve spojení s Microsoftem napadlo mì nìco jako gigantická reklama, pou¾ívají to v¹ichni, tak to musí být dobré a v èem je to opravdu lep¹í? Na to poslední mìl odpovìdìt tento seriál, ale moc se mu to nepovedlo :-(</p>

<p>Abych to shrnul, asi jste si v¹imli, ¾e se jedná pøedev¹ím o varování vnitøního hlasu. Nìkomu staèit nemusí, mì ano. Nemám ¾ádný pádný dùvod, proè bych nemìl pøejít a pokud nebude, o programování v DirectX se pokou¹et nebudu. Jediné, co by mì mohlo pøemluvit, by byla mo¾nost pracovat v nìjaké programátorské spoleènosti, která preferuje výhradnì DirectX, pak bych zaèal uva¾ovat, ale v souèasnosti zkrátka nemám dùvod...</p>


<h3>V èem je Direct3D lep¹í ne¾ OpenGL</h3>

<p>Asi nejmarkantnìj¹í výhoda Direct3D oproti OpenGL je pøítomnost ostatních DX knihoven pro zvuky, sí»ování ad., které dohromady vytváøejí jeden ucelený balík èili DirectX SDK (jmenuje se to tak?). Pokud kódujete poèítaèové hry, máte k dispozici na jednom místì snad v¹echno, co potøebujete a nemusíte po internetu slo¾itì hledat, jak loadovat a vykreslit 3ds model (Umí Direct3D i tohle? Jestli ano, opravdu respekt :-), nahrát jpg obrázek, naprogramovat multiplayer, pøehrát empétrojku a podobnì. Podle mého názoru se ve (Windows) hrách roz¹íøilo právì a pøedev¹ím z tohoto dùvodu.</p>

<p>OpenGL je jen a pouze pro rendering, v¹e ostatní musíte vytvoøit jinými nástroji jako jsou SDL a jeho podknihovny (SDL_image, SDL_sound, SDL_net, SDL_mixer...) urèené pøedev¹ím pro tvorbu poèítaèových her, OpenAL nebo FMOD na zvuky a dal¹í, které ov¹em ne ka¾dý zná (sly¹el o nich) a umí je pou¾ívat.</p>

<p>Na druhou stranu, budeme-li na chvíli ignorovat hry a podíváme-li se na nástroje typu Blender, 3D Studio Max, Mayu, Solid Works a dal¹í, i v dne¹ních dobách OpenGL jasnì vede - k èemu by v tìchto programech byly zvuky nebo multiplayer? Poznámka pro ¹»ouraly: Ano, Direct3D se v souèasnosti zaèíná dostávat i do této oblasti.</p>

<p>Argument, ¾e DirectX pou¾ívá v souèasnosti cca. 99 procent v¹ech nových her, je sice pravdivý, ale nic neøíká o tom, jestli je D3D opravdu lep¹í ne¾ OpenGL. Tím bych se jako zastánce D3D urèitì nevytahoval. Mohly by se napsat desítky/stovky analogických pøíkladù, ale vìt¹ina z nich by nebyla naprosto jednoznaèná - typicky Windows s Linuxem ap.</p>

<p>Z diskuze si pùjèím pøíklad MS IE a Mozilly, který pova¾uji za hodnì názorný. Naprostá vìt¹ina tzv. kanceláøských u¾ivatelù si myslí, ¾e internet = prohlí¾eè MS IE a absolutnì nedoká¾í pochopit, ¾e se na web dá dostat i pomocí jiných programù - napø. u mojí mámy to byly i po ukázce Opery tøi hodiny zoufalého vysvìtlování, poèítaè i net pou¾ívá dennì :-(. Nedávno mì pøi rozhovoru o prohlí¾eèích s jedním uèitelem, kterého si vá¾ím a který o poèítaèích ví opravdu hodnì, dostalo, ¾e rozhovor o IE, Mozille a Opeøe zavr¹il tím, ¾e pou¾ívá MyIE. Hlavní argument: Je zalo¾eno na MS IE, tak¾e zobrazuje v¹echno stejnì jako MS IE. Asi nejvìt¹í úlet, jaký jsem od nìj kdy sly¹el. Nìkdy mì baví vkládat do kaskádových stylù nekonèící komentáøe /*nefunguje v IE*/. Promiòte, opìt odbíhám od tématu.</p>

<p>Objektová architektura mù¾e být výhodou a zároveò i nevýhodou. Výhodou je, ¾e se scéna mù¾e organizovat do hierarchických blokù (padlo to v diskuzi, nevím, ale je to logické). Nevýhodou oproti strukturálnímu OpenGL mù¾e být slo¾itìj¹í napojení na nejrùznìj¹í programovací jazyky a pøedev¹ím mnohem nároènìj¹í uèení (po nìjaké dobì odpadá).</p>

<p>Nevýhodu bych spatøoval pøedev¹ím v &quot;OOP na bázi COM&quot;. V ¾ádném pøípadì neznamená, ¾e objektové programování = nepøenositelný program, nicménì ve spojení s COM bohu¾el ano. Dobøe napsaný OOP program bývá pøehlednìj¹í, robustnìj¹í a sndnìji modifikovatelnìj¹í ne¾ strukturovaný, o ¹patnì napsaném OOP programu se nebudu vyjadøovat, myslím, ¾e ka¾dý jsme vytvoøili minimálnì jeden, ale spí¹e mnohem víc. Jestli je DirectX dobrý nebo ¹patný OOP nedoká¾i objektivnì posoudit, ve srovnání s OpenGL vidím pøedev¹ím ty nevýhody.</p>

<p>Lidé kteøí zkou¹ejí Direct3D na jeho objekty nadávají a lidé, kteøí zkou¹ejí OpenGL, zase chtìjí, aby bylo objektové - co si vybrat? Mì osobnì strukturální OpenGL naprosto vyhovuje, asi proto, ¾e jsem na nìj zvyklý, objekty mi pøipadají jako zbyteèné komplikace. Mimochodem na COM, ActiveX a dal¹í technologie mám hodnì negativní názor, tak¾e radìji bez komentáøe.</p>

<p>Dal¹í výhodou Direct3D mù¾e být, ¾e se pøímo do nìj neustále pøidávají nové funkce, u nich¾ není vùbec podstatné, jestli je grafická karta podporuje. Pokud ne, mohou se bez nejmen¹ích po¾adavkù na programátora aplikovat softwarovì, v OpenGL se musí o nepøítomnost efektu (extensionu) starat výhradnì programátor. Je otázkou, jestli se pøi kompletní softwarové emulaci nìjakého efektu nestane hra natolik trhanou, ¾e bude nehratelná (nemám zku¹enosti).</p>

<p>U OpenGL se jakákoli supermoderní novinka zprovozòuje pøes extensiony, ty ale také mají své plusy i mínusy. Pozitivní je, ¾e se jakýkoli efekt mù¾e pou¾ít naprosto ihned po vydání karty a bez opìtovného mìnìní základního standardu, jaké lze vidìt u D3D (teï my¹leno pøidávání nových funkcí, ne zmìny stávajícího rozhraní).</p>

<p>Nevýhodou je, ¾e pokud se roz¹íøením nevìnujete dennì, ale pouze obèas - spí¹e vùbec, máte v nich naprostý zmatek a nepou¾íváte je, popø. pou¾íváte pouze malý zlomek z nich (mùj pøípad). To, co mi na nich vadí nejvíce, je tedy jejich poèet - odhaduji cca. 300 a neustále roste :-(. Naproti tomu, ka¾dá nová verze DirectX je ucelený balík, který &quot;extensiony obsahuje bez toho, ¾e se chovají jako extensiony&quot;. Logicky vzato DirectX s ka¾dou novou verzí narùstá také a programátor se musí novinkám vìnovat úplnì stejnì jako novým OpenGL extenzionùm. Mám pravdu nebo je to jenom blud?</p>

<p>Teï zapomeòte na DirectX, budu popisovat pouze OpenGL. Jistý pøíspìvek do diskuze: <i>Takze OpenGL je vlastne jen maly jadro funkcionality plus milion nekompatibilnich rozsireni, ktery se lisej od implementace k implementaci? To je fakt ohromna vyhoda :)</i> Ne, v ¾ádném pøípadì. Procesory CISC a RISC jsou dobrý pøíklad. CISC (Classic Instruction Set Computer) typicky implementuje instrukce na naprosto v¹echno, co si jen doká¾e výrobce pøedstavit. RISC (Reduced Instruction Set Computer) jde naprosto opaènou cestou - implementuje pouze nìkolik základních instrukcí a jejich kombinacemi umí provést úplnì v¹echno, co CISC. Pøesto¾e je nyní jedna instrukce nahrazená za deset podinstrukcí a vykonání zabere desetkrát více èasu, jsou RISC mnohem výkonnìj¹í.</p>

<p>Jde o to, ¾e cca. 20% v¹ech instrukcí CISC (sèítání, odèítání, porovnání...) se vyskytuje v kódu v 80% v¹ech pøípadù a zbývajících 80% instrukcí (multimedia ap.) se vyu¾ívá ve 20% - tzv. zákon osmdesát dvaceti, dvacet osmdesáti. Základní OpenGL standard by se teoreticky dal pøirovnat k RISC procesoru, OpenGL s extensiony k CISC, ale neberte to úplnì doslova, jedná se o úplnì nìco jiného. Spousta grafických efektù (vertex a fragment shadery ap.) jsou natolik nároèné, ¾e implementovat je podinstrukcemi (softwarovì) by bylo absolutnì nereálné. Extensiony jsou v uvozovkách bonus, do kterého se sahá spí¹e výjimeènì (tìch 20% pøípadù, spí¹e mnohem ménì), které ale umí a¾ neskuteèné vìci.</p>


<h3>Chyby a nepøesnosti z minulých dílù</h3>

<p>První a celkem velká je, ¾e neexistuje nic s názvem DirectNet. Tento termín byl pou¾it v literatuøe, ze které jsem èerpal, ale máte pravdu, mìl jsem si to ovìøit. V diskuzi se pak objevilo jméno DirectPlay.</p>

<p>Èíslování verzí DirectX: I kdy¾ v souèasnosti existuje DirectX 9.0(plus nìco na konci), není jich devìt, ale ménì/více. Nìkterá èísla byla pøeskoèena a naopak bylo nìkolik podverzí. Èlovìku, který nezaèal na DirectX 1.0, by mìlo podle mého názoru urèení devíti verzí postaèovat, ale díky, ¾e jste mì opravili.</p>

<p>Nekompatibilita jednotlivých verzí DirectX: Osobnì s tímto nemám ¾ádné zku¹enosti, ale kdy¾ to øekne devìt a pùl èlovìka z deseti lidí :-) Podle toho, co jsem sly¹el, pøi¹lo témìø v ka¾dé nové verzi mnoho zlomových úprav, nicménì v tuto chvíli nedoká¾i posoudit, jestli je to pravda nebo ne. Rozhraní knihoven by se obecnì nemìlo nikdy mìnit - maximálnì ve zlomových verzích, napø. chystané OpenGL 2.0. Upøímnì, kterou verzi (verze) DirectX byste oznaèili jako podobnì zlomové?</p>

<p>Objektové DirectX: Neznám pøesnou definici, ale za OOP jsem si v¾dy dosazoval slova jako tøídy, objekty, metody, atributy a dal¹í vìci, co¾ DirectX urèitì má. Ka¾dý èlovìk, který je trochu pøi smyslech, urèitì chápe, ¾e kdy¾ se nìkde pou¾ívají klíèová slova jako class ap., tak je oznaèení OOP více ne¾ pøiléhavé. Co lidi nìkdy nevygenerují... smajlík-nechápavého-kroucení-hlavou-).</p>

<p>Porovnání délky kódu ve druhém dílu :-((((( Asi jen tolik, ¾e jsem byl totální magor, kdy¾ jsem se do nìèeho takového pou¹tìl. Ukázkový pøíklad nebyl reálný. Zapomenout by na nìj asi ne¹lo, ¾e?</p>

<p>Co se týèe kontroly chyb pøi volání glVertex*(), které se nachází mimo glBegin/glEnd. Nevím, jak vy, ale na tento problém jsem je¹tì nikdy nenarazil a to i kdy¾ jsem za dobu u OpenGL procházel zdrojáky od spousty naprostých zaèáteèníkù. Manuálové stránky (man glVertex) udávají, ¾e &quot;Invoking glVertex outside of a glBegin/glEnd pair results in undefined behavior&quot;, tak¾e pokud se správnì pochopí slovní spojení nedefinované chování, je to jednotné naprosto na v¹ech platformách :-), ale máte pravdu, jednotnìj¹í zpùsob by byl lep¹í. Kompilátor tuto chybu sice neodhalí, ale programátor s tím nemá absolutnì ¾ádné problémy. Toto téma patøí spí¹e do teoretické roviny.</p>

<p>Troufám si øíct, ¾e OpenGL kód byl naprosto korektní, stejnì jako jeho Direct3D verze. Chybové testy byly v celé knize o Direct3D doporuèovány, jsou tedy nutné nebo ne?! U OpenGL bych øekl, ¾e spí¹e ne, mo¾ná výjimeènì, ale urèitì je naprosto zbyteèné testovat ka¾dé glVertex*() a glColor*(), jestli probìhlo v poøádku - absolutní blbost.</p>

<p>U OpenGL renderingu jsem vertex arrays sice pou¾ít mohl, ale nepou¾il. Jak u¾ bylo mnohokrát zmínìno programování v OpenGL a DirectX se ve své podstatì hodnì li¹í, cílem byl ekvivalentní grafický efekt NE zdrojový kód ...nebo posloupnost vygenerovaných jednièek a nul :-)</p>

<p>Mohl bych pokraèovat dál, ale èlánek zaèíná hodnì narùstat.</p>


<h3>Závìr</h3>

<p>Abych to nìjak zakonèil, dal¹í pokraèování urèitì nebudou - Johance a vlastnì v¹em ètenáøùm se je¹tì jednou omlouvám. Pøi psaní tohoto èlánku jsem pochopil, ¾e na porovnání OpenGL a DirectX prostì nemám (koneènì?). Pokud si myslíte, ¾e vy ano, mù¾ete to zkusit, ale nedoporuèuji...</p>

<p>I s ultra gigantickými znalostmi skonèíte v¾dy jako ten ¹patný. U mì to sice bylo z vìt¹í èásti zpùsobeno mými neznalostmi Direct3D, ale existuje spousta odborníkù napø. na Windows i Linux, kteøí se je pokou¹eli veøejnì porovnat a v dùsledku toho, je pøestaly uznávat obì strany. Jediné, co vám mohu slíbit je, ¾e v budoucnu budu psát (pokud budu psát, je¹tì nevím) u¾ jenom o tom, co opravdu ovládám a prakticky pou¾ívám.</p>

<p>Na po¾ádání - WOQ (zavináè) seznam.cz - vám mù¾u (<strong>pro osobní potøebu!</strong>) zaslat i dal¹í díly, které sice byly napsány, ale nevyjdou. Mazat se mi je nechce, byla na nich spousta práce. Ètení pouze na vlastní nebezpeèí. Je to ve formátu HTML, je¹tì pøed rozsekáním na jednotlivé díly, které jsem pak poslal Johance, cca. 2 MB.</p>

<p>Závìreèná poznámka: Kdybych napsal tento èlánek jako první a zároveò poslední díl série, jak byste ho vzali?</p>


<div>Pro server <a href="http://www.root.cz/">root.cz</a> napsal</div>
<div>Michal Turek - Woq <span class="m">&lt;WOQ (zavináè) seznam.cz&gt;</span></div>

</div><!-- div id="text_stranky" -->

</body>
</html>